<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>东风雪铁龙</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=yes">
    <meta name="format-detection" content="email=yes">
    <link rel="stylesheet" href="css/style.css" type="text/css"/>
    <script src="js/FontAuto.js"></script>
</head>


<body>
<div class="head-top-bg">雪铁龙</div>
<dl class="acticity">
    <dt><i class="a1"></i>活动说明<i class="b1"></i></dt>
    <dd>在3月10日至4月15日期间，所有在东风雪铁龙支付宝服务窗正确填写个
        人信息的客户，均可参与迎春体验季活动；活动内容包括：购车订金随机
        减、全系试驾送豪礼、备附件礼券送不停。</dd>
</dl>

<form  method="post" action="index2.html">

    <div class="form">
        <label class="form-label1" ><span class="form-name">姓名</span><input id="name" type="text" value="" name="" /></label>
        <label class="form-label2"><span class="form-tel">联系方式</span><input id="tel" type="text" value="" name="" /></label>

        <div class="form-label3">
            <span class="form-website">选择网点</span>

            <label class="form-sel">
                <select id="province">
                    <option value="">请选择省份</option>
                </select>
                <span class="pro-bg">请选择省份</span>
            </label>

            <label class="form-sel">
                <select id="city">
                    <option value="">请选择城市</option>
                </select>
                <span class="pro-bg">请选择城市</span>
            </label>

        </div>
        <div class="form-label4 website">
            <label class="form-sel">
                <select id="website">
                    <option value="">请选择网点</option>
                </select>
                <span class="pro-bg">请选择网点</span>
            </label>
        </div>
        <input id="address" type="hidden" value="" />
        <input id="comTel" type="hidden" value="" />
        <input id="code" type="hidden" value="" />
    </div>
    <div class="map"></div>
    <input class="btn" type="submit" value="确认提交"/>
</form>
<script src="js/zepto.min.js"></script>
<script src="js/location_chs.js"></script>

<script>
    $('form').submit(function(){
        var nameVal= $.trim($('#name').val());
        var telReg=/^1[3|4|5|7|8][0-9]\d{4,8}$/;
        var telVal= $.trim($('#tel').val());
        if(nameVal=='')
        {
            alert('请输入您的姓名！');
            return false;
        }
        if(!telReg.test(telVal))
        {
            alert("请输入正确的手机号！");
            return false;
        }
    });


    /*三级联动*/
    var selectObj={
      //  map:new BMap.Map("allmap"),
        local:null,
        province:document.querySelector('#province'),
        city:document.querySelector('#city'),
        website:document.querySelector('#website'),
        optionData:function(json,obj){
            var frag=document.createDocumentFragment();//碎片
            for(var i in json)//i是dataCountry数据的属性
            {
                var option=document.createElement("option");//创建option节点
                option.value=i;//将属性i赋值给option的value
                option.innerHTML=i;
                frag.appendChild(option);
            }
            obj.appendChild(frag);
        },
        optionJson:function(json,obj){
            var frag=document.createDocumentFragment();//碎片
            for(var i in json)//i是dataCountry数据的属性
            {
                var option=document.createElement("option");//创建option节点
                option.value=json[i];//将属性i赋值给option的value
                option.innerHTML=json[i];
                frag.appendChild(option);
            }
            obj.appendChild(frag);
        },
        init:function(){
            selectObj.optionData(dataCountry.province,selectObj.province);//初始
            console.log(1);
            //第一个下拉菜单
            selectObj.province.addEventListener('change',function(){
                var val=$(this).val();

                $(selectObj.city).html('<option value="">请选择城市</option>');
                $(selectObj.city).val("");
                $(selectObj.city).siblings('.pro-bg').css("color","#929292").text('请选择城市');


                $(selectObj.website).html('<option value="">请选择网点</option>');
                $(selectObj.website).val("");
                $(selectObj.website).siblings('.pro-bg').css("color","#929292").text('请选择网点');
                if(val=='')
                {
                    val='请选择省份';
                    $(this).siblings('span').css('color','#929292').text(val);
                }
                else
                {
                    $(this).siblings('span').css('color','#000').text(val);
                    selectObj.optionJson(dataCountry.province[val],selectObj.city);
                }
                console.log(2);
            });

            //第二个下拉菜单
            selectObj.city.addEventListener('change',function(){
                var val=$(this).val();

                $(selectObj.website).html('<option value="">请选择网点</option>');
                $(selectObj.website).val("");
                $(selectObj.website).siblings('.pro-bg').css("color","#929292").text('请选择网点');
                if(val=='')
                {
                    val='请选择城市';
                    $(this).siblings('span').css('color','#929292').text(val);
                }
                else
                {
                    $(this).siblings('span').css('color','#000').text(val);
                    selectObj.optionJson(dataCountry.company[val],selectObj.website);
                }
            });

            //第二个下拉菜单
            selectObj.website.addEventListener('change',function(){
                var val=$(this).val();

                if(val=='')
                {
                    val='请选择网点';
                    $(this).siblings('span').css('color','#929292').text(val);

                    $('#address,#comTel,#code').val('');
                }
                else
                {
                    $(this).siblings('span').css('color','#000').text(val);

                    var arr=dataCountry.address[val];
                    $('#address').val(arr[0]);
                    $('#comTel').val(arr[1]);
                    $('#code').val(arr[2]);

                    window.setTimeout(function(){
                        selectObj.local.search(val);
                    },800);

                }
            });
        }
    };
    selectObj.init();
</script>

</body>
</html>